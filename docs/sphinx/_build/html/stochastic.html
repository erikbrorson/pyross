

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Stochastic simulations &mdash; PyRoss 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hybrid simulations" href="hybrid.html" />
    <link rel="prev" title="Deterministic simulations" href="deterministic.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PyRoss
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="deterministic.html">Deterministic simulations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Stochastic simulations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stochastic-integration">stochastic_integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spp">Spp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sppq">SppQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sir">SIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sikr">SIkR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#seir">SEIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#seairq">SEAIRQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#seairq-testing">SEAIRQ_testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hybrid.html">Hybrid simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Bayesian inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">Control with NPIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="contactMatrix.html">Contact matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="forecast.html">Forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyRoss</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Stochastic simulations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stochastic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stochastic-simulations">
<h1>Stochastic simulations<a class="headerlink" href="#stochastic-simulations" title="Permalink to this headline">¶</a></h1>
<p>Stochastic simulations with compartment models and age structure. Has Gillespie and tau-leaping implemented.</p>
<div class="section" id="stochastic-integration">
<h2>stochastic_integration<a class="headerlink" href="#stochastic-integration" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.stochastic_integration">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">stochastic_integration</code><a class="headerlink" href="#pyross.stochastic.stochastic_integration" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Integrators used by stochastic models:</dt><dd><p>Gillespie and tau-leaping</p>
</dd>
</dl>
<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.A">
<code class="sig-name descname">A</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.A" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>A</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Activated population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.E">
<code class="sig-name descname">E</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.E" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Exposed population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.I">
<code class="sig-name descname">I</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.I" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ia</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Asymptomatics population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Ia">
<code class="sig-name descname">Ia</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Ia" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ia</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Asymptomatics population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Ic">
<code class="sig-name descname">Ic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Ic" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ICU hospitalized population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Icp">
<code class="sig-name descname">Icp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Icp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Icp</strong> – and recovered) population time series</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(intermediate stage between ICU</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Ih">
<code class="sig-name descname">Ih</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Ih" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>hospitalized population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Ihp">
<code class="sig-name descname">Ihp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Ihp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ihp</strong> – and recovered) population time series</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(intermediate stage between symptomatics</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Im">
<code class="sig-name descname">Im</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Im" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mortality time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Is">
<code class="sig-name descname">Is</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Is" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Is</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>symptomatics population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Isp">
<code class="sig-name descname">Isp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Isp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Isp</strong> – and recovered) population time series</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(intermediate stage between symptomatics</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.R">
<code class="sig-name descname">R</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.R" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>R</strong> (<em>Removed population time series</em>)</p></li>
<li><p><strong>For SEAI8R</strong> (<em>R=N(t)-(S+E+Ia+Is+Is’+Ih+Ih’+Ic+Ic’)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.S">
<code class="sig-name descname">S</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.S" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>S</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Susceptible population time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.Sx">
<code class="sig-name descname">Sx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.Sx" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data dict</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Generic compartment Sx</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.check_for_event">
<code class="sig-name descname">check_for_event</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.check_for_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.simulate_gillespie">
<code class="sig-name descname">simulate_gillespie</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.simulate_gillespie" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the stochastic simulation using the Gillespie algorithm.</p>
<ol class="arabic simple">
<li><p>Rates for each reaction channel r_i calculated from current state.</p></li>
<li><p>The timestep tau is chosen randomly from an exponential distribution P ~ e^(-W tau).</p></li>
<li><p>A single reaction occurs with probablity proportional to its fractional rate constant r_i/W.</p></li>
<li><p>The state is updated to reflect this reaction occuring and time is propagated forward by tau</p></li>
</ol>
<p>Stops if population becomes too small.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contactMatrix</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – The social contact matrix C_{ij} denotes the
average number of contacts made per day by an
individual in class i with an individual in class j</p></li>
<li><p><strong>Tf</strong> (<em>float</em>) – Final time of integrator</p></li>
<li><p><strong>Nf</strong> (<em>Int</em>) – Number of time points to evaluate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t_arr</strong> (<em>np.array(Nf,)</em>) – Array of time points at which the integrator was evaluated.</p></li>
<li><p><strong>out_arr</strong> (<em>np.array</em>) – Output path from integrator.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.stochastic_integration.simulate_tau_leaping">
<code class="sig-name descname">simulate_tau_leaping</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.stochastic_integration.simulate_tau_leaping" title="Permalink to this definition">¶</a></dt>
<dd><p>Tau leaping algorithm for producing stochastically correct trajectories
<a class="reference external" href="https://doi.org/10.1063/1.2159468">https://doi.org/10.1063/1.2159468</a>
This method can run much faster than the Gillespie algorithm</p>
<ol class="arabic simple">
<li><p>Rates for each reaction channel r_i calculated from current state.</p></li>
<li><p>Timestep tau chosen such that Delta r_i &lt; epsilon Sum r_i</p></li>
<li><p>Number of reactions that occur in channel i ~Poisson(r_i tau)</p></li>
<li><p>Update state by this amount</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contactMatrix</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – The social contact matrix C_{ij} denotes the
average number of contacts made per day by an
individual in class i with an individual in class j</p></li>
<li><p><strong>Tf</strong> (<em>float</em>) – Final time of integrator</p></li>
<li><p><strong>Nf</strong> (<em>Int</em>) – Number of time points to evaluate.</p></li>
<li><p><strong>nc</strong> (<em>optional</em>) – The default is 30</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>optional</em>) – The acceptable error in each step. The default is 0.03</p></li>
<li><p><strong>tau_update_frequency</strong> (<em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t_arr</strong> (<em>np.array(Nf,)</em>) – Array of time points at which the integrator was evaluated.</p></li>
<li><p><strong>out_arr</strong> (<em>np.array</em>) – Output path from integrator.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="spp">
<h2>Spp<a class="headerlink" href="#spp" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.Spp">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">Spp</code><a class="headerlink" href="#pyross.stochastic.Spp" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic user-defined epidemic model.</p>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_spec</strong> (<em>dict</em>) – A dictionary specifying the model. See <cite>Examples</cite>.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em>) – A dictionary containing the model parameters.
All parameters can be float if not age-dependent, and np.array(M,) if age-dependent</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>3*M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>An example of model_spec and parameters for SIR class with a constant influx</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model_spec</span> <span class="o">=</span> <span class="p">{</span>
<span class="go">        &quot;classes&quot; : [&quot;S&quot;, &quot;I&quot;],</span>
<span class="go">        &quot;S&quot; : {</span>
<span class="go">            &quot;constant&quot;  : [ [&quot;k&quot;] ],</span>
<span class="go">            &quot;infection&quot; : [ [&quot;I&quot;, &quot;-beta&quot;] ]</span>
<span class="go">        },</span>
<span class="go">        &quot;I&quot; : {</span>
<span class="go">            &quot;linear&quot;    : [ [&quot;I&quot;, &quot;-gamma&quot;] ],</span>
<span class="go">            &quot;infection&quot; : [ [&quot;I&quot;, &quot;beta&quot;] ]</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
<span class="go">        &#39;beta&#39;: 0.1,</span>
<span class="go">        &#39;gamma&#39;: 0.1,</span>
<span class="go">        &#39;k&#39;: 1,</span>
<span class="go">    }</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyross.stochastic.Spp.model_class_data">
<code class="sig-name descname">model_class_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.Spp.model_class_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – The object returned by <cite>simulate</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The population of class <cite>model_class_key</cite> as a time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.Spp.simulate">
<code class="sig-name descname">simulate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.Spp.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Stochastic Simulation Algorithm (SSA)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>np.array</em>) – Initial condition.</p></li>
<li><p><strong>contactMatrix</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – The social contact matrix C_{ij} denotes the
average number of contacts made per day by an
individual in class i with an individual in class j</p></li>
<li><p><strong>Tf</strong> (<em>float</em>) – Final time of integrator</p></li>
<li><p><strong>Nf</strong> (<em>Int</em>) – Number of time points to evaluate.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – SSA to use, either ‘gillespie’ or ‘tau_leaping’.
The default is ‘gillespie’.</p></li>
<li><p><strong>nc</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>tau_update_frequency</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X: output path from integrator,  t : time points evaluated at,
‘event_occured’ , ‘param’: input param to integrator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sppq">
<h2>SppQ<a class="headerlink" href="#sppq" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.deterministic.SppQ">
<em class="property">class </em><code class="sig-prename descclassname">pyross.deterministic.</code><code class="sig-name descname">SppQ</code><a class="headerlink" href="#pyross.deterministic.SppQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic user-defined epidemic model with quarantine.
…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_spec</strong> (<em>dict</em>) – A dictionary specifying the model. See <cite>Examples</cite>.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em>) – Contains the values for the parameters given in the model specification.
All parameters can be float if not age-dependent, and np.array(M,) if age-dependent</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>An example of model_spec and parameters for SIR class with a constant influx,
random testing (without false positives/negatives), and quarantine</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model_spec</span> <span class="o">=</span> <span class="p">{</span>
<span class="go">        &quot;classes&quot; : [&quot;S&quot;, &quot;I&quot;],</span>
<span class="go">        &quot;S&quot; : {</span>
<span class="go">            &quot;infection&quot; : [ [&quot;I&quot;, &quot;-beta&quot;] ]</span>
<span class="go">        },</span>
<span class="go">        &quot;I&quot; : {</span>
<span class="go">            &quot;linear&quot;    : [ [&quot;I&quot;, &quot;-gamma&quot;] ],</span>
<span class="go">            &quot;infection&quot; : [ [&quot;I&quot;, &quot;beta&quot;] ]</span>
<span class="go">        },</span>
<span class="go">        &quot;test_pos&quot;  : [ &quot;p_falsepos&quot;, &quot;p_truepos&quot;, &quot;p_falsepos&quot;] ,</span>
<span class="go">        &quot;test_freq&quot; : [ &quot;tf&quot;, &quot;tf&quot;, &quot;tf&quot;]</span>
<span class="go">    }</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
<span class="go">        &#39;beta&#39;: 0.1,</span>
<span class="go">        &#39;gamma&#39;: 0.1,</span>
<span class="go">        &#39;p_falsepos&#39;: 0</span>
<span class="go">        &#39;p_truepos&#39;: 1</span>
<span class="go">        &#39;tf&#39;: 1</span>
<span class="go">    }</span>
</pre></div>
</div>
<dl class="py method">
<dt id="pyross.deterministic.SppQ.model_class_data">
<code class="sig-name descname">model_class_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.deterministic.SppQ.model_class_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – The object returned by <cite>simulate</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The population of class <cite>model_class_key</cite> as a time series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.deterministic.SppQ.simulate">
<code class="sig-name descname">simulate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.deterministic.SppQ.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates a compartment model given initial conditions,
choice of integrator and other parameters.
Returns the time series data and parameters in a dict.
Internally calls the method ‘simulator’ of CommonMethods</p>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>np.array</em><em> or </em><em>dict</em>) – Initial conditions. If it is an array it should have length
M*(model_dimension-1), where x0[i + j*M] should be the initial
value of model class i of age group j. The removed R class
must be left out. If it is a dict then
it should have a key corresponding to each model class,
with a 1D array containing the initial condition for each
age group as value. One of the classes may be left out,
in which case its initial values will be inferred from the
others.</p></li>
<li><p><strong>contactMatrix</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – The social contact matrix C_{ij} denotes the
average number of contacts made per day by an
individual in class i with an individual in class j</p></li>
<li><p><strong>testRate</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – The total number of PCR tests performed per day</p></li>
<li><p><strong>Tf</strong> (<em>float</em>) – Final time of integrator</p></li>
<li><p><strong>Nf</strong> (<em>Int</em>) – Number of time points to evaluate.</p></li>
<li><p><strong>Ti</strong> (<em>float</em><em>, </em><em>optional</em>) – Start time of integrator. The default is 0.</p></li>
<li><p><strong>integrator</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – Integrator to use either from scipy.integrate or odespy.
The default is ‘odeint’.</p></li>
<li><p><strong>maxNumSteps</strong> (<em>int</em><em>, </em><em>optional</em>) – maximum number of steps the integrator can take.
The default value is 100000.</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs for integrator</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> –  X: output path from integrator,  t : time points evaluated at,
‘param’: input param to integrator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sir">
<h2>SIR<a class="headerlink" href="#sir" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.SIR">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">SIR</code><a class="headerlink" href="#pyross.stochastic.SIR" title="Permalink to this definition">¶</a></dt>
<dd><p>Susceptible, Infected, Removed (SIR)</p>
<ul class="simple">
<li><p>Ia: asymptomatic</p></li>
<li><p>Is: symptomatic</p></li>
</ul>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – <p>Contains the following keys:</p>
<dl class="simple">
<dt>alpha: float, np.array (M,)</dt><dd><p>fraction of infected who are asymptomatic.</p>
</dd>
<dt>beta: float</dt><dd><p>rate of spread of infection.</p>
</dd>
<dt>gIa: float</dt><dd><p>rate of removal from asymptomatic individuals.</p>
</dd>
<dt>gIs: float</dt><dd><p>rate of removal from symptomatic individuals.</p>
</dd>
<dt>fsa: float</dt><dd><p>fraction by which symptomatic individuals self isolate.</p>
</dd>
<dt>seed: long</dt><dd><p>seed for pseudo-random number generator (optional).</p>
</dd>
</dl>
</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>3*M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt>
<code class="sig-name descname">rate_matrix:</code></dt>
<dd><p>Calculates the rate constant for each reaction channel.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">simulate:</code></dt>
<dd><p>Performs stochastic numerical integration.</p>
</dd></dl>

<dl class="py method">
<dt id="pyross.stochastic.SIR.simulate">
<code class="sig-name descname">simulate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.stochastic.SIR.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Stochastic Simulation Algorithm (SSA)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S0</strong> (<em>np.array</em>) – Initial number of susceptables.</p></li>
<li><p><strong>Ia0</strong> (<em>np.array</em>) – Initial number of asymptomatic infectives.</p></li>
<li><p><strong>Is0</strong> (<em>np.array</em>) – Initial number of symptomatic infectives.</p></li>
<li><p><strong>contactMatrix</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – The social contact matrix C_{ij} denotes the
average number of contacts made per day by an
individual in class i with an individual in class j</p></li>
<li><p><strong>Tf</strong> (<em>float</em>) – Final time of integrator</p></li>
<li><p><strong>Nf</strong> (<em>Int</em>) – Number of time points to evaluate.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – SSA to use, either ‘gillespie’ or ‘tau_leaping’.
The default is ‘gillespie’.</p></li>
<li><p><strong>nc</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>epsilon</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>tau_update_frequency</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X: output path from integrator,  t : time points evaluated at,
‘event_occured’ , ‘param’: input param to integrator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sikr">
<h2>SIkR<a class="headerlink" href="#sikr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.SIkR">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">SIkR</code><a class="headerlink" href="#pyross.stochastic.SIkR" title="Permalink to this definition">¶</a></dt>
<dd><p>Susceptible, Infected, Removed (SIkR). Method of k-stages of I</p>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – <p>Contains the following keys:</p>
<dl class="simple">
<dt>beta: float</dt><dd><p>rate of spread of infection.</p>
</dd>
<dt>gI: float</dt><dd><p>rate of removal from infectives.</p>
</dd>
<dt>fsa: float</dt><dd><p>fraction by which symptomatic individuals self isolate.</p>
</dd>
<dt>kI: int</dt><dd><p>number of stages of infection.</p>
</dd>
<dt>seed: long</dt><dd><p>seed for pseudo-random number generator (optional).</p>
</dd>
</dl>
</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>(</em><em>kI + 1</em><em>)</em><em>*M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="seir">
<h2>SEIR<a class="headerlink" href="#seir" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.SEIR">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">SEIR</code><a class="headerlink" href="#pyross.stochastic.SEIR" title="Permalink to this definition">¶</a></dt>
<dd><p>Susceptible, Exposed, Infected, Removed (SEIR)</p>
<ul class="simple">
<li><p>Ia: asymptomatic</p></li>
<li><p>Is: symptomatic</p></li>
<li><p>E: exposed</p></li>
</ul>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – <p>Contains the following keys:</p>
<dl class="simple">
<dt>alpha: float, np.array (M,)</dt><dd><p>fraction of infected who are asymptomatic.</p>
</dd>
<dt>beta: float</dt><dd><p>rate of spread of infection.</p>
</dd>
<dt>gIa: float</dt><dd><p>rate of removal from asymptomatic individuals.</p>
</dd>
<dt>gIs: float</dt><dd><p>rate of removal from symptomatic individuals.</p>
</dd>
<dt>fsa: float</dt><dd><p>fraction by which symptomatic individuals self isolate.</p>
</dd>
<dt>gE: float</dt><dd><p>rate of removal from exposed individuals.</p>
</dd>
<dt>seed: long</dt><dd><p>seed for pseudo-random number generator (optional).</p>
</dd>
</dl>
</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>4*M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="seairq">
<h2>SEAIRQ<a class="headerlink" href="#seairq" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.SEAIRQ">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">SEAIRQ</code><a class="headerlink" href="#pyross.stochastic.SEAIRQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Susceptible, Exposed, Asymptomatic and infected, Infected, Removed, Quarantined (SEAIRQ)</p>
<ul class="simple">
<li><p>Ia: asymptomatic</p></li>
<li><p>Is: symptomatic</p></li>
<li><p>E: exposed</p></li>
<li><p>A: asymptomatic and infectious</p></li>
<li><p>Q: quarantined</p></li>
</ul>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – <p>Contains the following keys:</p>
<dl class="simple">
<dt>alpha: float, np.array(M,)</dt><dd><p>fraction of infected who are asymptomatic.</p>
</dd>
<dt>beta: float</dt><dd><p>rate of spread of infection.</p>
</dd>
<dt>gIa: float</dt><dd><p>rate of removal from asymptomatic individuals.</p>
</dd>
<dt>gIs: float</dt><dd><p>rate of removal from symptomatic individuals.</p>
</dd>
<dt>gE: float</dt><dd><p>rate of removal from exposed individuals.</p>
</dd>
<dt>gA: float</dt><dd><p>rate of removal from activated individuals.</p>
</dd>
<dt>fsa: float</dt><dd><p>fraction by which symptomatic individuals self isolate.</p>
</dd>
<dt>tE<span class="classifier">float</span></dt><dd><p>testing rate and contact tracing of exposeds</p>
</dd>
<dt>tA<span class="classifier">float</span></dt><dd><p>testing rate and contact tracing of activateds</p>
</dd>
<dt>tIa: float</dt><dd><p>testing rate and contact tracing of asymptomatics</p>
</dd>
<dt>tIs: float</dt><dd><p>testing rate and contact tracing of symptomatics</p>
</dd>
<dt>seed: long</dt><dd><p>seed for pseudo-random number generator (optional).</p>
</dd>
</dl>
</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>6*M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="seairq-testing">
<h2>SEAIRQ_testing<a class="headerlink" href="#seairq-testing" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyross.stochastic.SEAIRQ_testing">
<em class="property">class </em><code class="sig-prename descclassname">pyross.stochastic.</code><code class="sig-name descname">SEAIRQ_testing</code><a class="headerlink" href="#pyross.stochastic.SEAIRQ_testing" title="Permalink to this definition">¶</a></dt>
<dd><p>Susceptible, Exposed, Asymptomatic and infected, Infected, Removed, Quarantined (SEAIRQ)</p>
<ul class="simple">
<li><p>E: exposed</p></li>
<li><p>A: Asymptomatic and infectious</p></li>
<li><p>Ia: asymptomatic</p></li>
<li><p>Is: symptomatic</p></li>
<li><p>Q: quarantined</p></li>
</ul>
<p>…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – <p>Contains the following keys:</p>
<dl class="simple">
<dt>alpha: float, np.array(M,)</dt><dd><p>fraction of infected who are asymptomatic.</p>
</dd>
<dt>beta: float</dt><dd><p>rate of spread of infection.</p>
</dd>
<dt>gIa: float</dt><dd><p>rate of removal from asymptomatic individuals.</p>
</dd>
<dt>gIs: float</dt><dd><p>rate of removal from symptomatic individuals.</p>
</dd>
<dt>gE: float</dt><dd><p>rate of removal from exposed individuals.</p>
</dd>
<dt>gA: float</dt><dd><p>rate of removal from activated individuals.</p>
</dd>
<dt>fsa: float</dt><dd><p>fraction by which symptomatic individuals self isolate.</p>
</dd>
<dt>ars: float</dt><dd><p>fraction of population admissible for random and symptomatic tests</p>
</dd>
<dt>kapE: float</dt><dd><p>fraction of positive tests for exposed individuals</p>
</dd>
<dt>seed: long</dt><dd><p>seed for pseudo-random number generator (optional).</p>
</dd>
</dl>
</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of compartments of individual for each class.
I.e len(contactMatrix)</p></li>
<li><p><strong>Ni</strong> (<em>np.array</em><em>(</em><em>6*M</em><em>, </em><em>)</em>) – Initial number in each compartment and class</p></li>
<li><p><strong>testRate</strong> (<em>python function</em><em>(</em><em>t</em><em>)</em>) – number of tests per day and age group</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hybrid.html" class="btn btn-neutral float-right" title="Hybrid simulations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deterministic.html" class="btn btn-neutral float-left" title="Deterministic simulations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ronojoy Adhikari, Austen Bolitho, Fernando Caballero, Michael Cates, Jakub Dolezal, Timothy Ekeh, Jules Guioth, Robert Jack, Julian Kappler, Lukas Kikuchi, Irene Li, Joseph Peterson, Patrick Pietzonka, Benjamin Remez, Paul Rohrbach, Rajesh Singh, and Günther Turk

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
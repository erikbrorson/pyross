

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contact matrix &mdash; PyRoss 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Forecasting" href="forecast.html" />
    <link rel="prev" title="Control with NPIs" href="control.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PyRoss
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="deterministic.html">Deterministic simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="stochastic.html">Stochastic simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="hybrid.html">Hybrid simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Bayesian inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">Control with NPIs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contact matrix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#contact-matrix-function">Contact Matrix Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spatial-contact-matrix">Spatial Contact Matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forecast.html">Forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyRoss</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Contact matrix</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/contactMatrix.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="contact-matrix">
<h1>Contact matrix<a class="headerlink" href="#contact-matrix" title="Permalink to this headline">¶</a></h1>
<p>Classes and methods to compute contact matrix of a meta-population. The contact matrix <span class="math notranslate nohighlight">\(C_{ij}\)</span> denotes the average number of contacts made per day by an individual in class <span class="math notranslate nohighlight">\(i\)</span> with an individual in class <span class="math notranslate nohighlight">\(j\)</span>. Clearly, the total number of contacts between group <span class="math notranslate nohighlight">\(i\)</span> to group <span class="math notranslate nohighlight">\(j\)</span> must equal the total number of contacts from group <span class="math notranslate nohighlight">\(j\)</span> to group <span class="math notranslate nohighlight">\(i\)</span>, and thus, for populations of fixed size the contact matrices obey the reciprocity relation <span class="math notranslate nohighlight">\(N_{i}C_{ij}=N_{j}C_{ji}\)</span>. Here <span class="math notranslate nohighlight">\(N_i\)</span> is the population in group <span class="math notranslate nohighlight">\(i\)</span>.</p>
<div class="section" id="contact-matrix-function">
<h2>Contact Matrix Function<a class="headerlink" href="#contact-matrix-function" title="Permalink to this headline">¶</a></h2>
<p>Generates contact matrix for given interventions</p>
<dl class="py class">
<dt id="pyross.contactMatrix.ContactMatrixFunction">
<em class="property">class </em><code class="sig-prename descclassname">pyross.contactMatrix.</code><code class="sig-name descname">ContactMatrixFunction</code><a class="headerlink" href="#pyross.contactMatrix.ContactMatrixFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a time dependent contact matrix</p>
<p>For prefactors <span class="math notranslate nohighlight">\(a_{W1}, a_{W2}, a_{S1}, a_{S2}, a_{O1}, a_{O2}\)</span>
that multiply the contact matrices CW, CS, and CO.
the final contact matrix is computed as</p>
<div class="math notranslate nohighlight">
\[CM_{ij} = CH_{ij} + (a_{W1})_i CW_{ij} (a_{W2})_j
            + (a_{S1})_i CW_{ij} (a_{S2})_j
            + (a_{O1})_i CO_{ij} (a_{O2})_j\]</div>
<p>For all the intervention functions, if a prefactor is passed as scalar,
it is set to be an M (=no. of metapopulation groups) dimensional vector
with all entries equal to the scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>CH</strong> (<em>2d np.array</em>) – Contact matrix at home</p></li>
<li><p><strong>CW</strong> (<em>2d np.array</em>) – Contact matrix at work</p></li>
<li><p><strong>CS</strong> (<em>2d np.array</em>) – Contact matrix at school</p></li>
<li><p><strong>CO</strong> (<em>2d np.array</em>) – Contact matrix at other locations</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyross.contactMatrix.ContactMatrixFunction.constant_contactMatrix">
<code class="sig-name descname">constant_contactMatrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.ContactMatrixFunction.constant_contactMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant contact matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aW</strong> (<em>float</em><em> or </em><em>array of size M</em><em>, </em><em>optional</em>) – Fraction of work contact per receiver of infection. Default is 1.</p></li>
<li><p><strong>aS</strong> (<em>float</em><em> or </em><em>array of size M</em><em>, </em><em>optional</em>) – Fraction of school contact per receiver of infection. Default is 1.</p></li>
<li><p><strong>aO</strong> (<em>float</em><em> or </em><em>array of size M</em><em>, </em><em>optional</em>) – Fraction of other contact per receiver of infection. Default is 1.</p></li>
<li><p><strong>aW2</strong> (<em>float</em><em> or </em><em>array of size M</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Fraction of work contact per giver of infection. If set to None,
aW2 = aW.</p></li>
<li><p><strong>aS2</strong> (<em>float</em><em> or </em><em>array of size M</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Fraction of school contact per giver of infection. If set to None,
aS2 = aS.</p></li>
<li><p><strong>aO2</strong> (<em>float</em><em> or </em><em>array of size M</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Fraction of other contact per giver of infection. If set to None,
aO2 = aO.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contactMatrix</strong> – A function that takes t as an argument and outputs the contact matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.contactMatrix.ContactMatrixFunction.get_individual_contactMatrices">
<code class="sig-name descname">get_individual_contactMatrices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.ContactMatrixFunction.get_individual_contactMatrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the internal CH, CW, CS and CO</p>
</dd></dl>

<dl class="py method">
<dt id="pyross.contactMatrix.ContactMatrixFunction.intervention_custom_temporal">
<code class="sig-name descname">intervention_custom_temporal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.ContactMatrixFunction.intervention_custom_temporal" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom temporal interventions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intervention_func</strong> (<em>callable</em>) – The calling signature is <cite>intervention_func(t, **kwargs)</cite>,
where t is time and kwargs are other keyword arguments for the function.
The function must return (aW, aS, aO),
where aW, aS and aO must be of shape (2, M)</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Keyword arguments for the function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contactMatrix</strong> – A function that takes t as an argument and outputs the contact matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>An example for an custom temporal intervetion that
allows for some anticipation and reaction time</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># using keyword arguments for parameters of the intervention</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="n">loc</span><span class="p">)</span><span class="o">/</span><span class="n">width</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">a_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">a_full</span><span class="p">,</span> <span class="n">a_full</span><span class="p">,</span> <span class="n">a_full</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contactMatrix</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">intervention_custom_temporal</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyross.contactMatrix.ContactMatrixFunction.interventions_temporal">
<code class="sig-name descname">interventions_temporal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.ContactMatrixFunction.interventions_temporal" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporal interventions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>np.array</em>) – Ordered array with temporal boundaries between the different interventions.</p></li>
<li><p><strong>interventions</strong> (<em>np.array</em>) – Ordered matrix with prefactors aW, aS, aO such that aW1=aW2=aW
during the different time intervals.
Note that len(interventions) = len(times) + 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contactMatrix</strong> – A function that takes t as an argument and outputs the contact matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.contactMatrix.ContactMatrixFunction.interventions_threshold">
<code class="sig-name descname">interventions_threshold</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.ContactMatrixFunction.interventions_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporal interventions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<em>np.array</em>) – Ordered array with temporal boundaries between the different interventions.</p></li>
<li><p><strong>interventions</strong> (<em>np.array</em>) – Array of shape [K+1,3, ..] with prefactors during different phases of intervention
The current state of the intervention is defined by
the largest integer “index” such that state[j] &gt;= thresholds[index,j] for all j.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>contactMatrix</strong> – A function that takes t as an argument and outputs the contact matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="spatial-contact-matrix">
<h2>Spatial Contact Matrix<a class="headerlink" href="#spatial-contact-matrix" title="Permalink to this headline">¶</a></h2>
<p>Approximates the spatial contact matrix given the locations, populations and areas of
the geographical regions and the overall age structured contact matrix.</p>
<dl class="py class">
<dt id="pyross.contactMatrix.SpatialContactMatrix">
<em class="property">class </em><code class="sig-prename descclassname">pyross.contactMatrix.</code><code class="sig-name descname">SpatialContactMatrix</code><a class="headerlink" href="#pyross.contactMatrix.SpatialContactMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for generating a spatial compartmental model with commute data</p>
<p>Let <span class="math notranslate nohighlight">\(\mu, \nu\)</span> denote spatial index and i, j denote age group index.</p>
<div class="math notranslate nohighlight">
\[C^{\mu\nu}_{ij} = \frac{1}{N^\mu_i} \widetilde{C}^{\mu \nu}_{ij}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>float</em>) – Parameter b in the above equation</p></li>
<li><p><strong>populations</strong> (<em>np.array</em><em>(</em><em>n_loc</em><em>, </em><em>M</em><em>)</em>) – Populations of regions by age groups. Here n_loc is the number of regions
and M is the number of age groups.</p></li>
<li><p><strong>areas</strong> (<em>np.array</em><em>(</em><em>n_loc</em><em>)</em>) – Areas of the geographical regions.</p></li>
<li><p><strong>commutes</strong> (<em>np.array</em><em>(</em><em>n_loc</em><em>, </em><em>n_loc</em><em>, </em><em>M</em><em>)</em>) – Each entry commute[mu, nu, i] needs to be the number of people of age
group i commuting from <span class="math notranslate nohighlight">\(\mu\)</span> to <span class="math notranslate nohighlight">\(\nu\)</span>.
Entries with <span class="math notranslate nohighlight">\(\mu = \nu\)</span> are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.contactMatrix.getCM">
<code class="sig-prename descclassname">contactMatrix.</code><code class="sig-name descname">getCM</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.getCM" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to compute contact matrices of a given country</p>
<p>The data is read from sheets at:</p>
<p><a class="reference external" href="https://github.com/rajeshrinet/pyross/tree/master/examples/data/contact_matrices_152_countries">https://github.com/rajeshrinet/pyross/tree/master/examples/data/contact_matrices_152_countries</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>country</strong> (<em>string</em>) – Default is India</p></li>
<li><p><strong>sheet</strong> (<em>int</em>) – Default is 1
sheet takes value 1 and 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>four np.arrays</strong> (<em>CH, CW, CS, CO of the given country</em>)</p></li>
<li><p><em>CH - home,</em></p></li>
<li><p><em>CW - work,</em></p></li>
<li><p><em>CS - school,</em></p></li>
<li><p><em>CO - other locations</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyross.contactMatrix.characterise_transient">
<code class="sig-prename descclassname">contactMatrix.</code><code class="sig-name descname">characterise_transient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyross.contactMatrix.characterise_transient" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximal eigenvalue (spectral abcissa),
initial groth rate (numerical abcissa),
the Kreiss constant (minimum bound of transient)
and time of transient growth</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>an MxM matrix</em>) – </p></li>
<li><p><strong>tol</strong> (<em>Used to find a first estimate of the pseudospectrum</em>) – </p></li>
<li><p><strong>theta</strong> (<em>normalizing factor found in Townley et al 2007</em><em>, </em><em>default 0</em>) – </p></li>
<li><p><strong>ord</strong> (<em>default 2</em><em>, </em><em>order of matrix norm</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>[spectral abcissa, numerical abcissa, Kreiss constant,</em></p></li>
<li><p><em>duration of transient, henrici’s departure from normalcy]</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="forecast.html" class="btn btn-neutral float-right" title="Forecasting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="control.html" class="btn btn-neutral float-left" title="Control with NPIs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ronojoy Adhikari, Austen Bolitho, Fernando Caballero, Michael Cates, Jakub Dolezal, Timothy Ekeh, Jules Guioth, Robert Jack, Julian Kappler, Lukas Kikuchi, Irene Li, Joseph Peterson, Patrick Pietzonka, Benjamin Remez, Paul Rohrbach, Rajesh Singh, and Günther Turk

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>